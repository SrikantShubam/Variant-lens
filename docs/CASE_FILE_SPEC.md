# Case File Specification v2.0.0

## Purpose
Portable, citable, versioned artifact for variant interpretation.

## Schema (JSON)

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["variantlens_version", "variant", "timestamp", "structure"],
  "properties": {
    "variantlens_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "variant": {
      "type": "string",
      "pattern": "^[A-Z0-9]+:p\\.[A-Z][a-z]{2}\\d+[A-Z][a-z]{2}$"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    },
    "structure": {
      "type": "object",
      "required": ["source"],
      "properties": {
        "source": {
          "enum": ["PDB", "AlphaFold", "Partial"]
        },
        "id": { "type": "string" },
        "resolution": { "type": "number" },
        "coverage": { "type": "string" },
        "url": { "type": "string", "format": "uri" }
      }
    },
    "agent_hypothesis": {
      "type": "object",
      "properties": {
        "text": { "type": "string" },
        "confidence": {
          "enum": ["high", "moderate", "low", "uncertain"]
        },
        "citations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "pmid": { "type": "string" },
              "doi": { "type": "string" },
              "title": { "type": "string" }
            }
          }
        }
      }
    },
    "validation": {
      "type": "object",
      "properties": {
        "in_set": { "type": "boolean" },
        "expert_agreement": {
          "enum": ["full", "partial", "none", "N/A"]
        }
      }
    }
  }
}
```

## Markdown Report Template

```markdown
# VariantLens Report

**Variant:** {{variant}}
**Generated:** {{timestamp}}
**Version:** {{variantlens_version}}

## Structure Context
Source: {{structure.source}} ({{structure.id}})
{{#if structure.resolution}}Resolution: {{structure.resolution}}Ã…{{/if}}

## Mechanism Hypothesis
{{agent_hypothesis.text}}

**Confidence:** {{agent_hypothesis.confidence}}

## Evidence
{{#each evidence}}
- {{this}}
{{/each}}

## Citations
{{#each agent_hypothesis.citations}}
- [{{this.pmid}}](https://pubmed.ncbi.nlm.nih.gov/{{this.pmid}}/)
{{/each}}

{{#if validation.in_set}}
## Validation Note
This variant is in the curated validation set.
Expert agreement: {{validation.expert_agreement}}
{{/if}}

---
*This report was generated by VariantLens-Open v{{variantlens_version}} for research and educational purposes only. Not for clinical use.*
```

## Versioning
Schema version matches software version
Breaking changes increment major version
Case files include version for future compatibility
